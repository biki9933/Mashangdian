{"remainingRequest":"D:\\test\\smdc\\Vue\\saoma-diancan-pc\\node_modules\\babel-loader\\lib\\index.js!D:\\test\\smdc\\Vue\\saoma-diancan-pc\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\test\\smdc\\Vue\\saoma-diancan-pc\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\test\\smdc\\Vue\\saoma-diancan-pc\\src\\page\\dish-management\\upload-dishes.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\test\\smdc\\Vue\\saoma-diancan-pc\\src\\page\\dish-management\\upload-dishes.vue","mtime":1733729370005},{"path":"D:\\test\\smdc\\Vue\\saoma-diancan-pc\\babel.config.js","mtime":1618227600000},{"path":"D:\\test\\smdc\\Vue\\saoma-diancan-pc\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1733062317302},{"path":"D:\\test\\smdc\\Vue\\saoma-diancan-pc\\node_modules\\babel-loader\\lib\\index.js","mtime":1733062318538},{"path":"D:\\test\\smdc\\Vue\\saoma-diancan-pc\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1733062317302},{"path":"D:\\test\\smdc\\Vue\\saoma-diancan-pc\\node_modules\\vue-loader\\lib\\index.js","mtime":1733062316941}],"contextDependencies":[],"result":["import \"core-js/modules/es6.object.define-property\";\nimport \"core-js/modules/es6.object.define-properties\";\nimport \"core-js/modules/es7.object.get-own-property-descriptors\";\nimport \"core-js/modules/es6.array.for-each\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.object.keys\";\nimport \"core-js/modules/es6.array.filter\";\nimport \"core-js/modules/es6.array.some\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es6.array.map\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"D:/test/smdc/Vue/saoma-diancan-pc/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _defineProperty from \"D:/test/smdc/Vue/saoma-diancan-pc/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nimport { mapGetters } from 'vuex';\nimport { getServerUrl as _getServerUrl } from '@/config';\nexport default {\n  data: function data() {\n    return {\n      headers: {},\n      loadmen: false,\n      loading: false,\n      category: [],\n      //菜品类目\n      company: [],\n      //菜品单位\n      action: this.Urls.admin.dishUpload,\n      load: false,\n      unitload: false,\n      //自定义单位按钮\n      catevalue: '',\n      //选中的菜品类目\n      name: '',\n      price: '',\n      compvalue: '',\n      //选中的菜品单位\n      goodsimage: [],\n      //商品图片\n      imageName: '',\n      unit: '',\n      //自定义的单位\n      but: '上架菜品',\n      dialogImageUrl: '',\n      dialogVisible: false,\n      pagenum: 0,\n      custom: false,\n      onsale: true,\n      id: '' //该条数据的id，用于编辑\n    };\n  },\n  computed: _objectSpread({}, mapGetters(['currentMerchant'])),\n  methods: {\n    getServerUrl: function getServerUrl() {\n      return _getServerUrl();\n    },\n    // 上传图片展开大图\n    handlepreview: function handlepreview(file) {\n      this.dialogImageUrl = file.url;\n      this.dialogVisible = true;\n    },\n    // 上传失败\n    onErr: function onErr(e) {\n      this.loading = false;\n      this.$message.error('上传失败,尝试重新上传');\n    },\n    // 上传时\n    project: function project(file) {\n      this.loading = true;\n    },\n    // 封面图移除文件时的钩子\n    bannerRemove: function bannerRemove(file, fileList) {\n      this.goodsimage = [];\n    },\n    // 上传成功：封面图\n    bannerSuccess: function bannerSuccess(res, file, fileList) {\n      this.goodsimage.push({\n        url: this.getServerUrl() + '/image/dish/' + res.data.imageName\n      });\n      this.imageName = res.data.imageName;\n      this.loading = false;\n    },\n    // 获取菜品类目和单位\n    obtaincate: function () {\n      var _obtaincate = _asyncToGenerator(/*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n        var params, categoryRes;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              params = {\n                merchantId: this.currentMerchant.id\n              }; // 只请求分类列表\n              _context.next = 4;\n              return new this.Request(this.Urls.admin.categoryListAll).modeget(params);\n            case 4:\n              categoryRes = _context.sent;\n              if (categoryRes.code === 0) {\n                this.category = categoryRes.categoryList.map(function (item) {\n                  return {\n                    value: item.name,\n                    label: item.name,\n                    id: item.id\n                  };\n                });\n              } else {\n                this.$message.error('获取分类列表失败');\n              }\n\n              // 设置固定的单位列表\n              this.company = [{\n                label: '份',\n                value: '份'\n              }, {\n                label: '个',\n                value: '个'\n              }, {\n                label: '盘',\n                value: '盘'\n              }, {\n                label: '碗',\n                value: '碗'\n              }, {\n                label: '杯',\n                value: '杯'\n              }, {\n                label: '瓶',\n                value: '瓶'\n              }, {\n                label: '条',\n                value: '条'\n              }, {\n                label: '块',\n                value: '块'\n              }, {\n                label: '只',\n                value: '只'\n              }, {\n                label: '斤',\n                value: '斤'\n              }, {\n                label: '自定义单位',\n                value: '自定义单位',\n                _id: '980',\n                unid: '980'\n              }];\n              _context.next = 13;\n              break;\n            case 9:\n              _context.prev = 9;\n              _context.t0 = _context[\"catch\"](0);\n              console.error('获取数据失败：', _context.t0);\n              this.$message.error('获取数据失败');\n            case 13:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, this, [[0, 9]]);\n      }));\n      function obtaincate() {\n        return _obtaincate.apply(this, arguments);\n      }\n      return obtaincate;\n    }(),\n    // 添加自定义单位\n    dishunit: function () {\n      var _dishunit = _asyncToGenerator(/*#__PURE__*/regeneratorRuntime.mark(function _callee2() {\n        var _this = this;\n        var exists;\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              this.unitload = true;\n              _context2.prev = 1;\n              if (this.unit) {\n                _context2.next = 5;\n                break;\n              }\n              this.$message.warning(\"请输入自定义单位\");\n              return _context2.abrupt(\"return\");\n            case 5:\n              // 检查单位是否已存在\n              exists = this.company.some(function (item) {\n                return item.value === _this.unit;\n              });\n              if (!exists) {\n                _context2.next = 9;\n                break;\n              }\n              this.$message.warning(\"该单位已存在\");\n              return _context2.abrupt(\"return\");\n            case 9:\n              // 直接添加到单位列表\n              this.company.unshift({\n                label: this.unit,\n                value: this.unit\n              });\n              this.$message.success(\"添加成功\");\n              this.compvalue = this.unit;\n              this.unit = '';\n              _context2.next = 18;\n              break;\n            case 15:\n              _context2.prev = 15;\n              _context2.t0 = _context2[\"catch\"](1);\n              this.$message.error('操作失败，请重试');\n            case 18:\n              _context2.prev = 18;\n              this.unitload = false;\n              return _context2.finish(18);\n            case 21:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, this, [[1, 15, 18, 21]]);\n      }));\n      function dishunit() {\n        return _dishunit.apply(this, arguments);\n      }\n      return dishunit;\n    }(),\n    bTn: function bTn(is) {\n      var _this2 = this;\n      this.load = true;\n      var cate = this.category.filter(function (item, index) {\n        return item.value == _this2.catevalue;\n      });\n      var category = cate.length == 0 ? '' : cate[0].id;\n      var obj = {\n        id: this.id,\n        name: this.name,\n        unitprice: this.price,\n        unit: this.compvalue == '自定义单位' ? '' : this.compvalue,\n        image: this.imageName,\n        onsale: this.onsale,\n        typeId: category,\n        //该分类下的id\n        merchantId: this.currentMerchant.id\n      };\n      if (is == '上架菜品') {\n        this.purequest(obj, is, this.Urls.admin.dishSave);\n      } else {\n        // 提交修改\n        this.purequest(obj, is, this.Urls.admin.dishSave);\n      }\n    },\n    // 提交或修改公用请求\n    purequest: function () {\n      var _purequest = _asyncToGenerator(/*#__PURE__*/regeneratorRuntime.mark(function _callee3(obj, is, url) {\n        var res;\n        return regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.prev = 0;\n              _context3.next = 3;\n              return new this.Request(url, obj).modepost();\n            case 3:\n              res = _context3.sent;\n              if (res.code !== 0) {\n                this.$message.warning(res.msg || \"操作失败\");\n              } else {\n                this.$message.success(res.msg || \"操作成功\");\n                this.$router.push({\n                  name: 'dishes'\n                });\n              }\n              this.load = false;\n              _context3.next = 12;\n              break;\n            case 8:\n              _context3.prev = 8;\n              _context3.t0 = _context3[\"catch\"](0);\n              this.load = false;\n              this.$message.error('服务器发生错误,请重试');\n            case 12:\n            case \"end\":\n              return _context3.stop();\n          }\n        }, _callee3, this, [[0, 8]]);\n      }));\n      function purequest(_x, _x2, _x3) {\n        return _purequest.apply(this, arguments);\n      }\n      return purequest;\n    }()\n  },\n  created: function created() {\n    this.headers = {\n      Authorization: localStorage.getItem(\"token\")\n    };\n\n    // 获取路由参数\n    var routeParams = this.$route.params;\n    console.log('Route params:', routeParams);\n\n    // 调用获取类目和单位的方法\n    this.obtaincate();\n\n    // 如果是编辑模式\n    if (routeParams.item) {\n      var item = routeParams.item;\n      this.but = '修改提交';\n      this.id = item.id;\n      this.catevalue = item.type ? item.type.name : ''; // 添加空值检查\n      this.name = item.name;\n      this.price = item.unitprice;\n      this.compvalue = item.unit;\n      if (item.image) {\n        this.goodsimage = [{\n          url: this.getServerUrl() + '/image/dish/' + item.image\n        }];\n        this.imageName = item.image;\n      }\n      this.onsale = item.onsale;\n    }\n  }\n};",{"version":3,"names":["mapGetters","getServerUrl","data","headers","loadmen","loading","category","company","action","Urls","admin","dishUpload","load","unitload","catevalue","name","price","compvalue","goodsimage","imageName","unit","but","dialogImageUrl","dialogVisible","pagenum","custom","onsale","id","computed","_objectSpread","methods","handlepreview","file","url","onErr","e","$message","error","project","bannerRemove","fileList","bannerSuccess","res","push","obtaincate","_obtaincate","_asyncToGenerator","regeneratorRuntime","mark","_callee","params","categoryRes","wrap","_callee$","_context","prev","next","merchantId","currentMerchant","Request","categoryListAll","modeget","sent","code","categoryList","map","item","value","label","_id","unid","t0","console","stop","apply","arguments","dishunit","_dishunit","_callee2","_this","exists","_callee2$","_context2","warning","abrupt","some","unshift","success","finish","bTn","is","_this2","cate","filter","index","length","obj","unitprice","image","typeId","purequest","dishSave","_purequest","_callee3","_callee3$","_context3","modepost","msg","$router","_x","_x2","_x3","created","Authorization","localStorage","getItem","routeParams","$route","log","type"],"sources":["src/page/dish-management/upload-dishes.vue"],"sourcesContent":["<template>\r\n\t<div class=\"ordering\">\r\n\t\t<el-breadcrumb separator-class=\"el-icon-arrow-right\">\r\n\t\t  <el-breadcrumb-item :to=\"{ path: '/dishes' }\">菜品管理</el-breadcrumb-item>\r\n\t\t  <el-breadcrumb-item>添加 / 编辑菜品</el-breadcrumb-item>\r\n\t\t</el-breadcrumb>\r\n\t\t<div class=\"content-view-ten\" v-loading=\"loading\">\r\n\t\t\t<!-- 分类选择 -->\r\n\t\t\t<div class=\"image-view-title\">\r\n\t\t\t\t<div class=\"image-list\">菜品类目</div>\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<el-select v-model=\"catevalue\" placeholder=\"请选择菜品类目\">\r\n\t\t\t\t\t    <el-option\r\n\t\t\t\t\t      v-for=\"item in category\"\r\n\t\t\t\t\t      :key=\"item.value\"\r\n\t\t\t\t\t      :label=\"item.label\"\r\n\t\t\t\t\t      :value=\"item.value\">\r\n\t\t\t\t\t    </el-option>\r\n\t\t\t\t\t  </el-select>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<!-- 菜品名称 -->\r\n\t\t\t<div class=\"image-view-title\">\r\n\t\t\t\t<div class=\"image-list\">菜品名称</div>\r\n\t\t\t\t<el-input v-model=\"name\" type=\"text\" placeholder=\"请输入菜品名称\" :clearable=\"true\"></el-input>\r\n\t\t\t</div>\r\n\t\t\t<div class=\"image-view-title\">\r\n\t\t\t\t<div class=\"image-list\">菜品价格(元)</div>\r\n\t\t\t\t<div class=\"upload-option\">\r\n\t\t\t\t\t<el-input v-model=\"price\" min=\"0\" type=\"number\" placeholder=\"请输入菜品价格\" :clearable=\"true\"></el-input>\r\n\t\t\t\t\t<el-select v-model=\"compvalue\" placeholder=\"请选择菜品单位\">\r\n\t\t\t\t\t    <el-option\r\n\t\t\t\t\t      v-for=\"item in company\"\r\n\t\t\t\t\t      :key=\"item.value\"\r\n\t\t\t\t\t      :label=\"item.label\"\r\n\t\t\t\t\t      :value=\"item.value\">\r\n\t\t\t\t\t    </el-option>\r\n\t\t\t\t\t</el-select>\r\n\t\t\t\t\t<!-- 自定义单位 -->\r\n\t\t\t\t\t<el-input v-if=\"compvalue == '自定义单位'\" type=\"text\" v-model=\"unit\" placeholder=\"请输入自定义单位\" :clearable=\"true\"></el-input>\r\n\t\t\t\t\t<div v-if=\"compvalue == '自定义单位'\" style=\"margin-right: 0 !important;\"><el-button type=\"success\" size=\"medium\" @click=\"dishunit()\" :loading=\"unitload\" :disabled=\"unitload\" style=\"width: 100%;padding: 12px 20px;\">添加自定义单位</el-button></div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<!-- 菜品图片 -->\r\n\t\t\t<div class=\"image-view-title\">\r\n\t\t\t\t<div class=\"image-list\">菜品图片</div>\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<el-upload\r\n                        :headers=\"headers\"\r\n\t\t\t\t\t    :action=\"action\"\r\n\t\t\t\t\t    list-type=\"picture-card\"\r\n\t\t\t\t\t    name=\"file\"\r\n\t\t\t\t\t    accept=\".jpg,.png,.webp,.jfif,.jpeg\"\r\n\t\t\t\t\t    :limit=\"1\"\r\n\t\t\t\t\t    :on-remove=\"bannerRemove\"\r\n\t\t\t\t\t    :on-success=\"bannerSuccess\"\r\n\t\t\t\t\t    :on-preview=\"handlepreview\"\r\n\t\t\t\t\t    :multiple=\"false\"\r\n\t\t\t\t\t    :on-error=\"onErr\"\r\n\t\t\t\t\t    :before-upload=\"project\"\r\n\t\t\t\t\t    :file-list=\"goodsimage\"\r\n\t\t\t\t\t    >\r\n\t\t\t\t\t    <i class=\"el-icon-plus\"></i>\r\n\t\t\t\t\t</el-upload>\r\n\t\t\t\t\t<el-dialog :visible.sync=\"dialogVisible\">\r\n\t\t\t\t\t    <img width=\"100%\" :src=\"dialogImageUrl\" alt=\"\">\r\n\t\t\t\t\t</el-dialog>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<!-- 提交 -->\r\n\t\t\t<div class=\"image-button\">\r\n\t\t\t\t<el-button type=\"success\" size=\"medium\" @click=\"bTn(but)\" :loading=\"load\" :disabled=\"load\">{{but}}</el-button>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\nimport { mapGetters } from 'vuex'\r\nimport { getServerUrl } from '@/config'\r\n\r\nexport default {\r\n\tdata() {\r\n\t\treturn {\r\n            headers:{},\r\n\t\t\tloadmen: false,\r\n\t\t\tloading: false,\r\n\t\t\tcategory:[],//菜品类目\r\n\t\t\tcompany:[],//菜品单位\r\n\t\t\taction: this.Urls.admin.dishUpload,\r\n\t\t\tload:false,\r\n\t\t\tunitload:false,//自定义单位按钮\r\n\t\t\tcatevalue:'',//选中的菜品类目\r\n\t\t\tname:'',\r\n\t\t\tprice:'',\r\n\t\t\tcompvalue:'',//选中的菜品单位\r\n\t\t\tgoodsimage:[],//商品图片\r\n            imageName:'',\r\n\t\t\tunit:'',//自定义的单位\r\n\t\t\tbut:'上架菜品',\r\n\t\t\tdialogImageUrl: '',\r\n\t\t\tdialogVisible: false,\r\n\t\t\tpagenum:0,\r\n\t\t\tcustom:false,\r\n            onsale:true,\r\n\t\t\tid:''//该条数据的id，用于编辑\r\n\t\t}\r\n\t},\r\n\tcomputed: {\r\n\t\t...mapGetters(['currentMerchant'])\r\n\t},\r\n\tmethods:{\r\n        getServerUrl(){\r\n            return getServerUrl()\r\n        },\r\n\t\t// 上传图片展开大图\r\n\t\thandlepreview(file) {\r\n\t\t    this.dialogImageUrl = file.url;\r\n\t\t    this.dialogVisible = true;\r\n\t\t},\r\n\t\t// 上传失败\r\n\t\tonErr(e){\r\n\t\t\tthis.loading = false\r\n\t\t\tthis.$message.error('上传失败,尝试重新上传');\r\n\t\t},\r\n\t\t// 上传时\r\n\t\tproject(file){\r\n\t\t\tthis.loading = true\r\n\t\t},\r\n\t\t// 封面图移除文件时的钩子\r\n\t\tbannerRemove(file, fileList) {\r\n\t\t    this.goodsimage = []\r\n\t\t},\r\n\t\t// 上传成功：封面图\r\n\t\tbannerSuccess(res, file, fileList){\r\n\t\t\tthis.goodsimage.push({url:this.getServerUrl()+'/image/dish/'+res.data.imageName})\r\n            this.imageName=res.data.imageName\r\n\t\t\tthis.loading = false\r\n\t\t},\r\n\t\t// 获取菜品类目和单位\r\n\t\tasync obtaincate(){\r\n            try {\r\n                const params = {\r\n                    merchantId: this.currentMerchant.id\r\n                }\r\n                // 只请求分类列表\r\n                const categoryRes = await new this.Request(this.Urls.admin.categoryListAll).modeget(params)\r\n                \r\n                if (categoryRes.code === 0) {\r\n                    this.category = categoryRes.categoryList.map(item => ({\r\n                        value: item.name,\r\n                        label: item.name,\r\n                        id: item.id\r\n                    }))\r\n                } else {\r\n                    this.$message.error('获取分类列表失败')\r\n                }\r\n                \r\n                // 设置固定的单位列表\r\n                this.company = [\r\n                    { label: '份', value: '份' },\r\n                    { label: '个', value: '个' },\r\n                    { label: '盘', value: '盘' },\r\n                    { label: '碗', value: '碗' },\r\n                    { label: '杯', value: '杯' },\r\n                    { label: '瓶', value: '瓶' },\r\n                    { label: '条', value: '条' },\r\n                    { label: '块', value: '块' },\r\n                    { label: '只', value: '只' },\r\n                    { label: '斤', value: '斤' },\r\n                    { label: '自定义单位', value: '自定义单位', _id: '980', unid: '980' }\r\n                ]\r\n            } catch (err) {\r\n                console.error('获取数据失败：', err)\r\n                this.$message.error('获取数据失败')\r\n            }\r\n        },\r\n\t\t// 添加自定义单位\r\n\t\tasync dishunit(){\r\n\t\t\tthis.unitload = true\r\n\t\t\ttry{\r\n\t\t\t\tif(!this.unit){\r\n\t\t\t\t\tthis.$message.warning(\"请输入自定义单位\")\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\t// 检查单位是否已存在\r\n\t\t\t\tconst exists = this.company.some(item => item.value === this.unit)\r\n\t\t\t\tif(exists){\r\n\t\t\t\t\tthis.$message.warning(\"该单位已存在\")\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\t// 直接添加到单位列表\r\n\t\t\t\tthis.company.unshift({ \r\n\t\t\t\t\tlabel: this.unit, \r\n\t\t\t\t\tvalue: this.unit \r\n\t\t\t\t})\r\n\t\t\t\tthis.$message.success(\"添加成功\")\r\n\t\t\t\tthis.compvalue = this.unit\r\n\t\t\t\tthis.unit = ''\r\n\t\t\t}catch(e){\r\n\t\t\t\tthis.$message.error('操作失败，请重试')\r\n\t\t\t}finally{\r\n\t\t\t\tthis.unitload = false\r\n\t\t\t}\r\n\t\t},\r\n\t\tbTn(is){\r\n\t\t\tthis.load = true\r\n\t\t\tlet cate = this.category.filter((item,index)=>{return item.value == this.catevalue})\r\n\t\t\tlet category = cate.length == 0 ? '' : cate[0].id\r\n\t\t\tconst obj = {\r\n\t\t\t\tid:this.id,\r\n\t\t\t\tname:this.name,\r\n\t\t\t\tunitprice:this.price,\r\n\t\t\t\tunit:this.compvalue == '自定义单位' ? '' : this.compvalue,\r\n                image:this.imageName,\r\n                onsale:this.onsale,\r\n\t\t\t\ttypeId:category,//该分类下的id\r\n                merchantId: this.currentMerchant.id\r\n\t\t\t}\r\n\t\t\tif(is == '上架菜品'){\r\n\t\t\t\tthis.purequest(obj,is,this.Urls.admin.dishSave)\r\n\t\t\t}else{\r\n\t\t\t\t// 提交修改\r\n\t\t\t\tthis.purequest(obj,is,this.Urls.admin.dishSave)\r\n\t\t\t}\r\n\t\t},\r\n\t\t// 提交或修改公用请求\r\n\t\tasync purequest(obj,is,url){\r\n\t\t\ttry{\r\n\t\t\t\tconst res = await new this.Request(url,obj).modepost()\r\n\t\t\t\tif(res.code !== 0){\r\n\t\t\t\t\tthis.$message.warning(res.msg || \"操作失败\")\r\n\t\t\t\t}else{\r\n\t\t\t\t\tthis.$message.success(res.msg || \"操作成功\")\r\n\t\t\t\t\tthis.$router.push({name:'dishes'})\r\n\t\t\t\t}\r\n\t\t\t\tthis.load = false\r\n\t\t\t}catch(e){\r\n\t\t\t\tthis.load = false\r\n\t\t\t\tthis.$message.error('服务器发生错误,请重试')\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tcreated() {\r\n        this.headers = {\r\n            Authorization: localStorage.getItem(\"token\")\r\n        }\r\n        \r\n        // 获取路由参数\r\n        const routeParams = this.$route.params\r\n        console.log('Route params:', routeParams)\r\n        \r\n        // 调用获取类目和单位的方法\r\n        this.obtaincate()\r\n        \r\n        // 如果是编辑模式\r\n        if(routeParams.item){\r\n            const item = routeParams.item\r\n            this.but = '修改提交'\r\n            this.id = item.id\r\n            this.catevalue = item.type ? item.type.name : ''  // 添加空值检查\r\n            this.name = item.name\r\n            this.price = item.unitprice\r\n            this.compvalue = item.unit\r\n            if(item.image) {\r\n                this.goodsimage = [{\r\n                    url: this.getServerUrl() + '/image/dish/' + item.image\r\n                }]\r\n                this.imageName = item.image\r\n            }\r\n            this.onsale = item.onsale\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped=\"scoped\">\r\n@import url(\"../../../style/overall.css\");\r\n.upload-option{\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tjustify-content: left;\r\n}\r\n.upload-option div{width: 25% !important; margin-right: 5px;}\r\n.el-button--success{width: 150px;}\r\n</style>\r\n"],"mappings":";;;;;;;;;;;;;;;AA8EA,SAAAA,UAAA;AACA,SAAAC,YAAA,IAAAA,aAAA;AAEA;EACAC,IAAA,WAAAA,KAAA;IACA;MACAC,OAAA;MACAC,OAAA;MACAC,OAAA;MACAC,QAAA;MAAA;MACAC,OAAA;MAAA;MACAC,MAAA,OAAAC,IAAA,CAAAC,KAAA,CAAAC,UAAA;MACAC,IAAA;MACAC,QAAA;MAAA;MACAC,SAAA;MAAA;MACAC,IAAA;MACAC,KAAA;MACAC,SAAA;MAAA;MACAC,UAAA;MAAA;MACAC,SAAA;MACAC,IAAA;MAAA;MACAC,GAAA;MACAC,cAAA;MACAC,aAAA;MACAC,OAAA;MACAC,MAAA;MACAC,MAAA;MACAC,EAAA;IACA;EACA;EACAC,QAAA,EAAAC,aAAA,KACA7B,UAAA,sBACA;EACA8B,OAAA;IACA7B,YAAA,WAAAA,aAAA;MACA,OAAAA,aAAA;IACA;IACA;IACA8B,aAAA,WAAAA,cAAAC,IAAA;MACA,KAAAV,cAAA,GAAAU,IAAA,CAAAC,GAAA;MACA,KAAAV,aAAA;IACA;IACA;IACAW,KAAA,WAAAA,MAAAC,CAAA;MACA,KAAA9B,OAAA;MACA,KAAA+B,QAAA,CAAAC,KAAA;IACA;IACA;IACAC,OAAA,WAAAA,QAAAN,IAAA;MACA,KAAA3B,OAAA;IACA;IACA;IACAkC,YAAA,WAAAA,aAAAP,IAAA,EAAAQ,QAAA;MACA,KAAAtB,UAAA;IACA;IACA;IACAuB,aAAA,WAAAA,cAAAC,GAAA,EAAAV,IAAA,EAAAQ,QAAA;MACA,KAAAtB,UAAA,CAAAyB,IAAA;QAAAV,GAAA,OAAAhC,YAAA,sBAAAyC,GAAA,CAAAxC,IAAA,CAAAiB;MAAA;MACA,KAAAA,SAAA,GAAAuB,GAAA,CAAAxC,IAAA,CAAAiB,SAAA;MACA,KAAAd,OAAA;IACA;IACA;IACAuC,UAAA;MAAA,IAAAC,WAAA,GAAAC,iBAAA,cAAAC,kBAAA,CAAAC,IAAA,UAAAC,QAAA;QAAA,IAAAC,MAAA,EAAAC,WAAA;QAAA,OAAAJ,kBAAA,CAAAK,IAAA,UAAAC,SAAAC,QAAA;UAAA,kBAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA;YAAA;cAAAF,QAAA,CAAAC,IAAA;cAEAL,MAAA;gBACAO,UAAA,OAAAC,eAAA,CAAA/B;cACA,GACA;cAAA2B,QAAA,CAAAE,IAAA;cAAA,OACA,SAAAG,OAAA,MAAAlD,IAAA,CAAAC,KAAA,CAAAkD,eAAA,EAAAC,OAAA,CAAAX,MAAA;YAAA;cAAAC,WAAA,GAAAG,QAAA,CAAAQ,IAAA;cAEA,IAAAX,WAAA,CAAAY,IAAA;gBACA,KAAAzD,QAAA,GAAA6C,WAAA,CAAAa,YAAA,CAAAC,GAAA,WAAAC,IAAA;kBAAA;oBACAC,KAAA,EAAAD,IAAA,CAAAnD,IAAA;oBACAqD,KAAA,EAAAF,IAAA,CAAAnD,IAAA;oBACAY,EAAA,EAAAuC,IAAA,CAAAvC;kBACA;gBAAA;cACA;gBACA,KAAAS,QAAA,CAAAC,KAAA;cACA;;cAEA;cACA,KAAA9B,OAAA,IACA;gBAAA6D,KAAA;gBAAAD,KAAA;cAAA,GACA;gBAAAC,KAAA;gBAAAD,KAAA;cAAA,GACA;gBAAAC,KAAA;gBAAAD,KAAA;cAAA,GACA;gBAAAC,KAAA;gBAAAD,KAAA;cAAA,GACA;gBAAAC,KAAA;gBAAAD,KAAA;cAAA,GACA;gBAAAC,KAAA;gBAAAD,KAAA;cAAA,GACA;gBAAAC,KAAA;gBAAAD,KAAA;cAAA,GACA;gBAAAC,KAAA;gBAAAD,KAAA;cAAA,GACA;gBAAAC,KAAA;gBAAAD,KAAA;cAAA,GACA;gBAAAC,KAAA;gBAAAD,KAAA;cAAA,GACA;gBAAAC,KAAA;gBAAAD,KAAA;gBAAAE,GAAA;gBAAAC,IAAA;cAAA,EACA;cAAAhB,QAAA,CAAAE,IAAA;cAAA;YAAA;cAAAF,QAAA,CAAAC,IAAA;cAAAD,QAAA,CAAAiB,EAAA,GAAAjB,QAAA;cAEAkB,OAAA,CAAAnC,KAAA,YAAAiB,QAAA,CAAAiB,EAAA;cACA,KAAAnC,QAAA,CAAAC,KAAA;YAAA;YAAA;cAAA,OAAAiB,QAAA,CAAAmB,IAAA;UAAA;QAAA,GAAAxB,OAAA;MAAA;MAAA,SAlCAL,WAAA;QAAA,OAAAC,WAAA,CAAA6B,KAAA,OAAAC,SAAA;MAAA;MAAA,OAAA/B,UAAA;IAAA;IAqCA;IACAgC,QAAA;MAAA,IAAAC,SAAA,GAAA/B,iBAAA,cAAAC,kBAAA,CAAAC,IAAA,UAAA8B,SAAA;QAAA,IAAAC,KAAA;QAAA,IAAAC,MAAA;QAAA,OAAAjC,kBAAA,CAAAK,IAAA,UAAA6B,UAAAC,SAAA;UAAA,kBAAAA,SAAA,CAAA3B,IAAA,GAAA2B,SAAA,CAAA1B,IAAA;YAAA;cACA,KAAA3C,QAAA;cAAAqE,SAAA,CAAA3B,IAAA;cAAA,IAEA,KAAAnC,IAAA;gBAAA8D,SAAA,CAAA1B,IAAA;gBAAA;cAAA;cACA,KAAApB,QAAA,CAAA+C,OAAA;cAAA,OAAAD,SAAA,CAAAE,MAAA;YAAA;cAGA;cACAJ,MAAA,QAAAzE,OAAA,CAAA8E,IAAA,WAAAnB,IAAA;gBAAA,OAAAA,IAAA,CAAAC,KAAA,KAAAY,KAAA,CAAA3D,IAAA;cAAA;cAAA,KACA4D,MAAA;gBAAAE,SAAA,CAAA1B,IAAA;gBAAA;cAAA;cACA,KAAApB,QAAA,CAAA+C,OAAA;cAAA,OAAAD,SAAA,CAAAE,MAAA;YAAA;cAGA;cACA,KAAA7E,OAAA,CAAA+E,OAAA;gBACAlB,KAAA,OAAAhD,IAAA;gBACA+C,KAAA,OAAA/C;cACA;cACA,KAAAgB,QAAA,CAAAmD,OAAA;cACA,KAAAtE,SAAA,QAAAG,IAAA;cACA,KAAAA,IAAA;cAAA8D,SAAA,CAAA1B,IAAA;cAAA;YAAA;cAAA0B,SAAA,CAAA3B,IAAA;cAAA2B,SAAA,CAAAX,EAAA,GAAAW,SAAA;cAEA,KAAA9C,QAAA,CAAAC,KAAA;YAAA;cAAA6C,SAAA,CAAA3B,IAAA;cAEA,KAAA1C,QAAA;cAAA,OAAAqE,SAAA,CAAAM,MAAA;YAAA;YAAA;cAAA,OAAAN,SAAA,CAAAT,IAAA;UAAA;QAAA,GAAAK,QAAA;MAAA;MAAA,SAxBAF,SAAA;QAAA,OAAAC,SAAA,CAAAH,KAAA,OAAAC,SAAA;MAAA;MAAA,OAAAC,QAAA;IAAA;IA2BAa,GAAA,WAAAA,IAAAC,EAAA;MAAA,IAAAC,MAAA;MACA,KAAA/E,IAAA;MACA,IAAAgF,IAAA,QAAAtF,QAAA,CAAAuF,MAAA,WAAA3B,IAAA,EAAA4B,KAAA;QAAA,OAAA5B,IAAA,CAAAC,KAAA,IAAAwB,MAAA,CAAA7E,SAAA;MAAA;MACA,IAAAR,QAAA,GAAAsF,IAAA,CAAAG,MAAA,aAAAH,IAAA,IAAAjE,EAAA;MACA,IAAAqE,GAAA;QACArE,EAAA,OAAAA,EAAA;QACAZ,IAAA,OAAAA,IAAA;QACAkF,SAAA,OAAAjF,KAAA;QACAI,IAAA,OAAAH,SAAA,wBAAAA,SAAA;QACAiF,KAAA,OAAA/E,SAAA;QACAO,MAAA,OAAAA,MAAA;QACAyE,MAAA,EAAA7F,QAAA;QAAA;QACAmD,UAAA,OAAAC,eAAA,CAAA/B;MACA;MACA,IAAA+D,EAAA;QACA,KAAAU,SAAA,CAAAJ,GAAA,EAAAN,EAAA,OAAAjF,IAAA,CAAAC,KAAA,CAAA2F,QAAA;MACA;QACA;QACA,KAAAD,SAAA,CAAAJ,GAAA,EAAAN,EAAA,OAAAjF,IAAA,CAAAC,KAAA,CAAA2F,QAAA;MACA;IACA;IACA;IACAD,SAAA;MAAA,IAAAE,UAAA,GAAAxD,iBAAA,cAAAC,kBAAA,CAAAC,IAAA,UAAAuD,SAAAP,GAAA,EAAAN,EAAA,EAAAzD,GAAA;QAAA,IAAAS,GAAA;QAAA,OAAAK,kBAAA,CAAAK,IAAA,UAAAoD,UAAAC,SAAA;UAAA,kBAAAA,SAAA,CAAAlD,IAAA,GAAAkD,SAAA,CAAAjD,IAAA;YAAA;cAAAiD,SAAA,CAAAlD,IAAA;cAAAkD,SAAA,CAAAjD,IAAA;cAAA,OAEA,SAAAG,OAAA,CAAA1B,GAAA,EAAA+D,GAAA,EAAAU,QAAA;YAAA;cAAAhE,GAAA,GAAA+D,SAAA,CAAA3C,IAAA;cACA,IAAApB,GAAA,CAAAqB,IAAA;gBACA,KAAA3B,QAAA,CAAA+C,OAAA,CAAAzC,GAAA,CAAAiE,GAAA;cACA;gBACA,KAAAvE,QAAA,CAAAmD,OAAA,CAAA7C,GAAA,CAAAiE,GAAA;gBACA,KAAAC,OAAA,CAAAjE,IAAA;kBAAA5B,IAAA;gBAAA;cACA;cACA,KAAAH,IAAA;cAAA6F,SAAA,CAAAjD,IAAA;cAAA;YAAA;cAAAiD,SAAA,CAAAlD,IAAA;cAAAkD,SAAA,CAAAlC,EAAA,GAAAkC,SAAA;cAEA,KAAA7F,IAAA;cACA,KAAAwB,QAAA,CAAAC,KAAA;YAAA;YAAA;cAAA,OAAAoE,SAAA,CAAAhC,IAAA;UAAA;QAAA,GAAA8B,QAAA;MAAA;MAAA,SAZAH,UAAAS,EAAA,EAAAC,GAAA,EAAAC,GAAA;QAAA,OAAAT,UAAA,CAAA5B,KAAA,OAAAC,SAAA;MAAA;MAAA,OAAAyB,SAAA;IAAA;EAeA;EACAY,OAAA,WAAAA,QAAA;IACA,KAAA7G,OAAA;MACA8G,aAAA,EAAAC,YAAA,CAAAC,OAAA;IACA;;IAEA;IACA,IAAAC,WAAA,QAAAC,MAAA,CAAAnE,MAAA;IACAsB,OAAA,CAAA8C,GAAA,kBAAAF,WAAA;;IAEA;IACA,KAAAxE,UAAA;;IAEA;IACA,IAAAwE,WAAA,CAAAlD,IAAA;MACA,IAAAA,IAAA,GAAAkD,WAAA,CAAAlD,IAAA;MACA,KAAA7C,GAAA;MACA,KAAAM,EAAA,GAAAuC,IAAA,CAAAvC,EAAA;MACA,KAAAb,SAAA,GAAAoD,IAAA,CAAAqD,IAAA,GAAArD,IAAA,CAAAqD,IAAA,CAAAxG,IAAA;MACA,KAAAA,IAAA,GAAAmD,IAAA,CAAAnD,IAAA;MACA,KAAAC,KAAA,GAAAkD,IAAA,CAAA+B,SAAA;MACA,KAAAhF,SAAA,GAAAiD,IAAA,CAAA9C,IAAA;MACA,IAAA8C,IAAA,CAAAgC,KAAA;QACA,KAAAhF,UAAA;UACAe,GAAA,OAAAhC,YAAA,sBAAAiE,IAAA,CAAAgC;QACA;QACA,KAAA/E,SAAA,GAAA+C,IAAA,CAAAgC,KAAA;MACA;MACA,KAAAxE,MAAA,GAAAwC,IAAA,CAAAxC,MAAA;IACA;EACA;AACA","ignoreList":[]}]}