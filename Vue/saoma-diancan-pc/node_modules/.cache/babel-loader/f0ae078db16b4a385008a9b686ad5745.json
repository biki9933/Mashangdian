{"remainingRequest":"D:\\git\\Mashangdian\\Vue\\saoma-diancan-pc\\node_modules\\babel-loader\\lib\\index.js!D:\\git\\Mashangdian\\Vue\\saoma-diancan-pc\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\git\\Mashangdian\\Vue\\saoma-diancan-pc\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\git\\Mashangdian\\Vue\\saoma-diancan-pc\\src\\page\\login\\login.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\git\\Mashangdian\\Vue\\saoma-diancan-pc\\src\\page\\login\\login.vue","mtime":1733139801575},{"path":"D:\\git\\Mashangdian\\Vue\\saoma-diancan-pc\\babel.config.js","mtime":1618227600000},{"path":"D:\\git\\Mashangdian\\Vue\\saoma-diancan-pc\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1733062317302},{"path":"D:\\git\\Mashangdian\\Vue\\saoma-diancan-pc\\node_modules\\babel-loader\\lib\\index.js","mtime":1733062318538},{"path":"D:\\git\\Mashangdian\\Vue\\saoma-diancan-pc\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1733062317302},{"path":"D:\\git\\Mashangdian\\Vue\\saoma-diancan-pc\\node_modules\\vue-loader\\lib\\index.js","mtime":1733062316941}],"contextDependencies":[],"result":["import \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"D:/git/Mashangdian/Vue/saoma-diancan-pc/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { Urls } from \"../../api/api.js\";\nexport default {\n  data: function data() {\n    return {\n      load: false,\n      userName: '',\n      password: '',\n      selectedMerchant: '',\n      merchantList: [],\n      Urls: Urls\n    };\n  },\n  created: function created() {\n    this.getMerchantList();\n  },\n  methods: {\n    getMerchantList: function () {\n      var _getMerchantList = _asyncToGenerator(/*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n        var res;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return new this.Request(this.Urls.admin.merchantList).modeget();\n            case 3:\n              res = _context.sent;\n              console.log('商户列表响应:', res);\n              if (res.code === 0) {\n                this.merchantList = res.merchantList;\n              } else {\n                this.$message.error(res.msg || '获取商户列表失败');\n              }\n              _context.next = 12;\n              break;\n            case 8:\n              _context.prev = 8;\n              _context.t0 = _context[\"catch\"](0);\n              console.error('获取商户列表错误:', _context.t0);\n              this.$message.error('获取商户列表失败');\n            case 12:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, this, [[0, 8]]);\n      }));\n      function getMerchantList() {\n        return _getMerchantList.apply(this, arguments);\n      }\n      return getMerchantList;\n    }(),\n    handleMerchantChange: function handleMerchantChange(merchantId) {\n      this.userName = '';\n      this.password = '';\n    },\n    signin: function () {\n      var _signin = _asyncToGenerator(/*#__PURE__*/regeneratorRuntime.mark(function _callee2() {\n        var loginData, res, redirect;\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              if (this.selectedMerchant) {\n                _context2.next = 3;\n                break;\n              }\n              this.$message.warning('请选择商户！');\n              return _context2.abrupt(\"return\");\n            case 3:\n              if (this.userName) {\n                _context2.next = 6;\n                break;\n              }\n              this.$message.warning('请输入用户名！');\n              return _context2.abrupt(\"return\");\n            case 6:\n              if (this.password) {\n                _context2.next = 9;\n                break;\n              }\n              this.$message.warning('请输入密码！');\n              return _context2.abrupt(\"return\");\n            case 9:\n              this.load = true;\n              loginData = {\n                userName: this.userName,\n                password: this.password,\n                merchantId: this.selectedMerchant\n              };\n              _context2.prev = 11;\n              _context2.next = 14;\n              return new this.Request(this.Urls.admin.login, loginData).modepost();\n            case 14:\n              res = _context2.sent;\n              if (res.code === 0) {\n                // 更新vuex状态\n                this.$store.commit('SET_MERCHANT', {\n                  id: res.data.adminInfo.merchantId,\n                  name: res.data.adminInfo.merchantName\n                });\n\n                // 保存token\n                this.$store.commit('SET_USER_INFO', {\n                  token: res.data.token,\n                  userInfo: {\n                    userName: this.userName,\n                    merchantId: res.data.adminInfo.merchantId\n                  }\n                });\n\n                // 显示成功消息\n                this.$message.success('登录成功');\n\n                // 获取重定向地址\n                redirect = this.$route.query.redirect || '/'; // 跳转\n                this.$router.push(redirect);\n              } else {\n                this.$message.warning(res.msg || '登录失败');\n              }\n              _context2.next = 22;\n              break;\n            case 18:\n              _context2.prev = 18;\n              _context2.t0 = _context2[\"catch\"](11);\n              console.error('登录错误:', _context2.t0);\n              this.$message.error('登录异常，请重试');\n            case 22:\n              _context2.prev = 22;\n              this.load = false;\n              return _context2.finish(22);\n            case 25:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, this, [[11, 18, 22, 25]]);\n      }));\n      function signin() {\n        return _signin.apply(this, arguments);\n      }\n      return signin;\n    }()\n  }\n};",{"version":3,"names":["Urls","data","load","userName","password","selectedMerchant","merchantList","created","getMerchantList","methods","_getMerchantList","_asyncToGenerator","regeneratorRuntime","mark","_callee","res","wrap","_callee$","_context","prev","next","Request","admin","modeget","sent","console","log","code","$message","error","msg","t0","stop","apply","arguments","handleMerchantChange","merchantId","signin","_signin","_callee2","loginData","redirect","_callee2$","_context2","warning","abrupt","login","modepost","$store","commit","id","adminInfo","name","merchantName","token","userInfo","success","$route","query","$router","push","finish"],"sources":["src/page/login/login.vue"],"sourcesContent":["<template>\r\n    <div id=\"backcont\">\r\n        <div class=\"meituan-content\">\r\n            <div class=\"login-cont\">\r\n                <div class=\"meituan-title\">扫码点餐登录</div>\r\n                <div class=\"meituan-user\">\r\n                    <p>商户</p>\r\n                    <el-select class=\"inptflex\" v-model=\"selectedMerchant\" placeholder=\"请选择商户\" @change=\"handleMerchantChange\">\r\n                        <el-option\r\n                            v-for=\"item in merchantList\"\r\n                            :key=\"item.id\"\r\n                            :label=\"item.merchantName\"\r\n                            :value=\"item.id\">\r\n                        </el-option>\r\n                    </el-select>\r\n                </div>\r\n                <div class=\"meituan-user\">\r\n                    <p>账号</p>\r\n                    <el-input class=\"inptflex\" v-model=\"userName\" placeholder=\"请输入账号\" :disabled=\"!selectedMerchant\"></el-input>\r\n                </div>\r\n                <div class=\"meituan-user\">\r\n                    <p>密码</p>\r\n                    <el-input class=\"inptflex\" v-model=\"password\" placeholder=\"请输入密码\" show-password :disabled=\"!selectedMerchant\"></el-input>\r\n                </div>\r\n                <el-button type=\"success\" class=\"meituan-btn\" @click=\"signin()\" :loading=\"load\" :disabled=\"load || !selectedMerchant\">登录</el-button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { Urls } from '../../api/api.js'\r\n\r\nexport default {\r\n    data() {\r\n        return {\r\n            load: false,\r\n            userName: '',\r\n            password: '',\r\n            selectedMerchant: '',\r\n            merchantList: [],\r\n            Urls: Urls\r\n        }\r\n    },\r\n    created() {\r\n        this.getMerchantList()\r\n    },\r\n    methods: {\r\n        async getMerchantList() {\r\n            try {\r\n                const res = await new this.Request(this.Urls.admin.merchantList).modeget()\r\n                console.log('商户列表响应:', res)\r\n                \r\n                if (res.code === 0) {\r\n                    this.merchantList = res.merchantList\r\n                } else {\r\n                    this.$message.error(res.msg || '获取商户列表失败')\r\n                }\r\n            } catch (e) {\r\n                console.error('获取商户列表错误:', e)\r\n                this.$message.error('获取商户列表失败')\r\n            }\r\n        },\r\n\r\n        handleMerchantChange(merchantId) {\r\n            this.userName = ''\r\n            this.password = ''\r\n        },\r\n\r\n        async signin() {\r\n            if (!this.selectedMerchant) {\r\n                this.$message.warning('请选择商户！')\r\n                return\r\n            }\r\n            if (!this.userName) {\r\n                this.$message.warning('请输入用户名！')\r\n                return\r\n            }\r\n            if (!this.password) {\r\n                this.$message.warning('请输入密码！')\r\n                return\r\n            }\r\n\r\n            this.load = true\r\n            const loginData = {\r\n                userName: this.userName,\r\n                password: this.password,\r\n                merchantId: this.selectedMerchant\r\n            }\r\n\r\n            try {\r\n                const res = await new this.Request(this.Urls.admin.login, loginData).modepost()\r\n                if (res.code === 0) {\r\n                    // 更新vuex状态\r\n                    this.$store.commit('SET_MERCHANT', {\r\n                        id: res.data.adminInfo.merchantId,\r\n                        name: res.data.adminInfo.merchantName\r\n                    })\r\n                    \r\n                    // 保存token\r\n                    this.$store.commit('SET_USER_INFO', {\r\n                        token: res.data.token,\r\n                        userInfo: {\r\n                            userName: this.userName,\r\n                            merchantId: res.data.adminInfo.merchantId\r\n                        }\r\n                    })\r\n\r\n                    // 显示成功消息\r\n                    this.$message.success('登录成功')\r\n                    \r\n                    // 获取重定向地址\r\n                    const redirect = this.$route.query.redirect || '/'\r\n                    // 跳转\r\n                    this.$router.push(redirect)\r\n                } else {\r\n                    this.$message.warning(res.msg || '登录失败')\r\n                }\r\n            } catch (e) {\r\n                console.error('登录错误:', e)\r\n                this.$message.error('登录异常，请重试')\r\n            } finally {\r\n                this.load = false\r\n            }\r\n        }\r\n\t}\r\n}\r\n\r\n</script>\r\n\r\n<style scoped=\"scoped\">\r\n#backcont {\r\n\tbackground-image: url(../../../static/login/beijing.jpg);\r\n\tbackground-attachment: fixed;\r\n\tbackground-repeat: no-repeat;\r\n\tbackground-size: cover;\r\n\t-webkit-background-size: cover;\r\n\tmoz-background-size: cover;\r\n\tmin-height: 100vh;\r\n}\r\n.meituan-content {\r\n\tposition: absolute;\r\n\ttop: 50%;\r\n\tleft: 50%;\r\n\ttransform: translate(-50%, -50%);\r\n}\r\n.login-cont {\r\n\twidth: 500px;\r\n\theight: 300px;\r\n\tbackground: #f9de80;\r\n\tborder-radius: 5px;\r\n}\r\n.meituan-title {\r\n\ttext-align: center;\r\n\tcolor: #000000;\r\n\tfont-size: 30px;\r\n\tpadding-top: 30px;\r\n\tfont-family: Arial, Helvetica, sans-serif;\r\n}\r\n.meituan-user {\r\n\twidth: 400px;\r\n\tmargin: 0 auto;\r\n\tpadding-top: 30px;\r\n\theight: 40px;\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n}\r\n\r\n.meituan-user p{width: 50px; color: #000000;\r\nfont-size:16px;\r\n}\r\n\r\n.inptflex{flex: 1;}\r\n\r\n.reg-view{\r\n\twidth: 400px;\r\n\tdisplay: flex;\r\n\tjustify-content: flex-end;\r\n\tmargin: 0 auto;\r\n\tpadding-top: 10px;\r\n\tcursor:pointer;\r\n}\r\n\r\n.meituan-btn {\r\n\twidth: 200px;\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tjustify-content: center;\r\n\tmargin: 20px auto 0 auto;\r\n\tfont-size: 16px;\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]}]}